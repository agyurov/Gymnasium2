---
title: "crosstabs (> ^ , ^)>"
output:
  pdf_document:
    toc: yes
    toc_depth: 3
    number_sections: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,message = FALSE, warning = FALSE,fig.height=2.5)
source("libraries.R")
load(".RData")
my_report <- function(...) {

  fmt <- rmarkdown::pdf_document(...)

  fmt$knitr$knit_hooks$size = function(before, options, envir) {
    if (before) return(paste0("\n \\", options$size, "\n\n"))
    else return("\n\n \\normalsize \n")
  }

  return(fmt)
}
```

```{r}
tmp = fbnum
a = tmp$q10.1_understand
af = a[tmp$q3.1_gender == "kvinde"]
am = a[tmp$q3.1_gender == "mand"]
aja = a[tmp$q5.1_digedu == "ja"]
anej = a[tmp$q5.1_digedu == "nej"]
#
b = rowMeans(tmp[,20:21])
b = round(b,1)
bf = b[tmp$q3.1_gender == "kvinde"]
bm = b[tmp$q3.1_gender == "mand"]
bja = b[tmp$q5.1_digedu == "ja"]
bnej = b[tmp$q5.1_digedu == "nej"]

#
c = rowMeans(tmp[,22:24])
c = round(c,1)
cf = c[tmp$q3.1_gender == "kvinde"]
cm = c[tmp$q3.1_gender == "mand"]
cja = c[tmp$q5.1_digedu == "ja"]
cnej = c[tmp$q5.1_digedu == "nej"]
```

# Definitions

* PK (perceived knowledge) - q10 understand  with unique values

`r sort(unique(a))`

* TR (trust) - "mean" of q15 trustsell and q16 trustpriv  with unique values

`r sort(unique(b))`

Note that $\mu(1,3) = \mu(3,1) = \mu(2,2)$ etc..s 

* ACP (acceptance of commerical practices) - "mean" of q17 targetme, q18 targetfr and q19 comfortsell  with unique values

`r sort(unique(c))`

* Large $\chi^2$ p-values indicate independence.



# Facebook

## Unconditional A x B x C

```{r}
kable(table(a,b),row.names = T,caption = paste0("PK x TR, $\\chi^2$ p-value: ",round(chisq.test(table(a,b))$p.value,2)))
kable(table(a,c),row.names = T,caption = paste0("PK x ACP, $\\chi^2$ p-value: ",round(chisq.test(table(a,c))$p.value,2)))
kable(table(b,c),row.names = T,caption = paste0("TR x ACP, $\\chi^2$ p-value: ",round(chisq.test(table(b,c))$p.value,2)))
```

## Conditioned on gender

```{r}
kable(table(af,bf),row.names = T,caption = paste0("PK female x TR female, $\\chi^2$ p-value: ",round(chisq.test(table(af,bf))$p.value,2)))
kable(table(af,cf),row.names = T,caption = paste0("PK female x ACP female, $\\chi^2$ p-value: ",round(chisq.test(table(af,cf))$p.value,2)))
kable(table(bf,cf),row.names = T,caption = paste0("TR female x ACP female, $\\chi^2$ p-value: ",round(chisq.test(table(bf,cf))$p.value,2)))
```

```{r}
kable(table(am,bm),row.names = T,caption = paste0("PK male x TR male, $\\chi^2$ p-value: ",round(chisq.test(table(am,bm))$p.value,2)))
kable(table(am,cm),row.names = T,caption = paste0("PK male x ACP male, $\\chi^2$ p-value: ",round(chisq.test(table(am,cm))$p.value,2)))
kable(table(bm,cm),row.names = T,caption = paste0("TR male x ACP male, $\\chi^2$ p-value: ",round(chisq.test(table(bm,cm))$p.value,2)))
```

## Conditioned on Digital education

```{r}
kable(table(aja,bja),row.names = T,caption = paste0("PK ja x TR ja, $\\chi^2$ p-value: ",round(chisq.test(table(aja,bja))$p.value,2)))
kable(table(aja,cja),row.names = T,caption = paste0("PK ja x ACP ja, $\\chi^2$ p-value: ",round(chisq.test(table(aja,cja))$p.value,2)))
kable(table(bja,cja),row.names = T,caption = paste0("TR ja x ACP ja, $\\chi^2$ p-value: ",round(chisq.test(table(bja,cja))$p.value,2)))
```

```{r}
kable(table(anej,bnej),row.names = T,caption = paste0("PK nej x TR nej, $\\chi^2$ p-value: ",round(chisq.test(table(anej,bnej))$p.value,2)))
kable(table(anej,cnej),row.names = T,caption = paste0("PK nej x ACP nej, $\\chi^2$ p-value: ",round(chisq.test(table(anej,cnej))$p.value,2)))
kable(table(bnej,cnej),row.names = T,caption = paste0("TR nej x ACP nej, $\\chi^2$ p-value: ",round(chisq.test(table(bnej,cnej))$p.value,2)))
```


# Instagram

```{r}
tmp = ignum
a = tmp$q10.1_understand
af = a[tmp$q3.1_gender == "kvinde"]
am = a[tmp$q3.1_gender == "mand"]
aja = a[tmp$q5.1_digedu == "ja"]
anej = a[tmp$q5.1_digedu == "nej"]
#
b = rowMeans(tmp[,20:21])
b = round(b,1)
bf = b[tmp$q3.1_gender == "kvinde"]
bm = b[tmp$q3.1_gender == "mand"]
bja = b[tmp$q5.1_digedu == "ja"]
bnej = b[tmp$q5.1_digedu == "nej"]

#
c = rowMeans(tmp[,22:24])
c = round(c,1)
cf = c[tmp$q3.1_gender == "kvinde"]
cm = c[tmp$q3.1_gender == "mand"]
cja = c[tmp$q5.1_digedu == "ja"]
cnej = c[tmp$q5.1_digedu == "nej"]
```

## Unconditional A x B x C

```{r}
kable(table(a,b),row.names = T,caption = paste0("PK x TR, $\\chi^2$ p-value: ",round(chisq.test(table(a,b))$p.value,2)))
kable(table(a,c),row.names = T,caption = paste0("PK x ACP, $\\chi^2$ p-value: ",round(chisq.test(table(a,c))$p.value,2)))
kable(table(b,c),row.names = T,caption = paste0("TR x ACP, $\\chi^2$ p-value: ",round(chisq.test(table(b,c))$p.value,2)))
```

## Conditioned on gender

```{r}
kable(table(af,bf),row.names = T,caption = paste0("PK female x TR female, $\\chi^2$ p-value: ",round(chisq.test(table(af,bf))$p.value,2)))
kable(table(af,cf),row.names = T,caption = paste0("PK female x ACP female, $\\chi^2$ p-value: ",round(chisq.test(table(af,cf))$p.value,2)))
kable(table(bf,cf),row.names = T,caption = paste0("TR female x ACP female, $\\chi^2$ p-value: ",round(chisq.test(table(bf,cf))$p.value,2)))
```

```{r}
kable(table(am,bm),row.names = T,caption = paste0("PK male x TR male, $\\chi^2$ p-value: ",round(chisq.test(table(am,bm))$p.value,2)))
kable(table(am,cm),row.names = T,caption = paste0("PK male x ACP male, $\\chi^2$ p-value: ",round(chisq.test(table(am,cm))$p.value,2)))
kable(table(bm,cm),row.names = T,caption = paste0("TR male x ACP male, $\\chi^2$ p-value: ",round(chisq.test(table(bm,cm))$p.value,2)))
```

## Conditioned on Digital education

```{r}
kable(table(aja,bja),row.names = T,caption = paste0("PK ja x TR ja, $\\chi^2$ p-value: ",round(chisq.test(table(aja,bja))$p.value,2)))
kable(table(aja,cja),row.names = T,caption = paste0("PK ja x ACP ja, $\\chi^2$ p-value: ",round(chisq.test(table(aja,cja))$p.value,2)))
kable(table(bja,cja),row.names = T,caption = paste0("TR ja x ACP ja, $\\chi^2$ p-value: ",round(chisq.test(table(bja,cja))$p.value,2)))
```

```{r}
kable(table(anej,bnej),row.names = T,caption = paste0("PK nej x TR nej, $\\chi^2$ p-value: ",round(chisq.test(table(anej,bnej))$p.value,2)))
kable(table(anej,cnej),row.names = T,caption = paste0("PK nej x ACP nej, $\\chi^2$ p-value: ",round(chisq.test(table(anej,cnej))$p.value,2)))
kable(table(bnej,cnej),row.names = T,caption = paste0("TR nej x ACP nej, $\\chi^2$ p-value: ",round(chisq.test(table(bnej,cnej))$p.value,2)))
```



# Snapchat

```{r}
tmp = scnum
a = tmp$q10.1_understand
af = a[tmp$q3.1_gender == "kvinde"]
am = a[tmp$q3.1_gender == "mand"]
aja = a[tmp$q5.1_digedu == "ja"]
anej = a[tmp$q5.1_digedu == "nej"]
#
b = rowMeans(tmp[,20:21])
b = round(b,1)
bf = b[tmp$q3.1_gender == "kvinde"]
bm = b[tmp$q3.1_gender == "mand"]
bja = b[tmp$q5.1_digedu == "ja"]
bnej = b[tmp$q5.1_digedu == "nej"]

#
c = rowMeans(tmp[,22:24])
c = round(c,1)
cf = c[tmp$q3.1_gender == "kvinde"]
cm = c[tmp$q3.1_gender == "mand"]
cja = c[tmp$q5.1_digedu == "ja"]
cnej = c[tmp$q5.1_digedu == "nej"]
```

## Unconditional A x B x C

```{r}
kable(table(a,b),row.names = T,caption = paste0("PK x TR, $\\chi^2$ p-value: ",round(chisq.test(table(a,b))$p.value,2)))
kable(table(a,c),row.names = T,caption = paste0("PK x ACP, $\\chi^2$ p-value: ",round(chisq.test(table(a,c))$p.value,2)))
kable(table(b,c),row.names = T,caption = paste0("TR x ACP, $\\chi^2$ p-value: ",round(chisq.test(table(b,c))$p.value,2)))
```

## Conditioned on gender

```{r}
kable(table(af,bf),row.names = T,caption = paste0("PK female x TR female, $\\chi^2$ p-value: ",round(chisq.test(table(af,bf))$p.value,2)))
kable(table(af,cf),row.names = T,caption = paste0("PK female x ACP female, $\\chi^2$ p-value: ",round(chisq.test(table(af,cf))$p.value,2)))
kable(table(bf,cf),row.names = T,caption = paste0("TR female x ACP female, $\\chi^2$ p-value: ",round(chisq.test(table(bf,cf))$p.value,2)))
```

```{r}
kable(table(am,bm),row.names = T,caption = paste0("PK male x TR male, $\\chi^2$ p-value: ",round(chisq.test(table(am,bm))$p.value,2)))
kable(table(am,cm),row.names = T,caption = paste0("PK male x ACP male, $\\chi^2$ p-value: ",round(chisq.test(table(am,cm))$p.value,2)))
kable(table(bm,cm),row.names = T,caption = paste0("TR male x ACP male, $\\chi^2$ p-value: ",round(chisq.test(table(bm,cm))$p.value,2)))
```

## Conditioned on Digital education

```{r}
kable(table(aja,bja),row.names = T,caption = paste0("PK ja x TR ja, $\\chi^2$ p-value: ",round(chisq.test(table(aja,bja))$p.value,2)))
kable(table(aja,cja),row.names = T,caption = paste0("PK ja x ACP ja, $\\chi^2$ p-value: ",round(chisq.test(table(aja,cja))$p.value,2)))
kable(table(bja,cja),row.names = T,caption = paste0("TR ja x ACP ja, $\\chi^2$ p-value: ",round(chisq.test(table(bja,cja))$p.value,2)))
```

```{r}
kable(table(anej,bnej),row.names = T,caption = paste0("PK nej x TR nej, $\\chi^2$ p-value: ",round(chisq.test(table(anej,bnej))$p.value,2)))
kable(table(anej,cnej),row.names = T,caption = paste0("PK nej x ACP nej, $\\chi^2$ p-value: ",round(chisq.test(table(anej,cnej))$p.value,2)))
kable(table(bnej,cnej),row.names = T,caption = paste0("TR nej x ACP nej, $\\chi^2$ p-value: ",round(chisq.test(table(bnej,cnej))$p.value,2)))
```
